
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Manta Ray Foraging\_10}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{random}
        \PY{k+kn}{import} \PY{n+nn}{math}\PY{o}{,}\PY{n+nn}{time}\PY{o}{,}\PY{n+nn}{sys}
        \PY{k+kn}{from} \PY{n+nn}{matplotlib} \PY{k}{import} \PY{n}{pyplot}
        \PY{k+kn}{from} \PY{n+nn}{datetime} \PY{k}{import} \PY{n}{datetime}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{neighbors} \PY{k}{import} \PY{n}{KNeighborsClassifier}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
        \PY{c+c1}{\PYZsh{} from sklearn.neural\PYZus{}network import MLPClassifier}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{RandomForestClassifier}
        
        
        \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}3}
        \PY{k}{def} \PY{n+nf}{sigmoid1}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{p}{:}     \PY{c+c1}{\PYZsh{}convert to probability}
        	\PY{k}{if} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{l+m+mi}{0}\PY{p}{:}
        		\PY{k}{return} \PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{math}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{p}{)}
        	\PY{k}{else}\PY{p}{:}
        		\PY{k}{return} \PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{math}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{p}{)}\PY{p}{)}
        
        \PY{k}{def} \PY{n+nf}{sigmoid2}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{p}{:}
        	\PY{n}{gamma} \PY{o}{/}\PY{o}{=} \PY{l+m+mi}{2}
        	\PY{k}{if} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{l+m+mi}{0}\PY{p}{:}
        		\PY{k}{return} \PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{math}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{p}{)}
        	\PY{k}{else}\PY{p}{:}
        		\PY{k}{return} \PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{math}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{p}{)}\PY{p}{)}
        
        \PY{k}{def} \PY{n+nf}{sigmoid3}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{p}{:}
        	\PY{n}{gamma} \PY{o}{/}\PY{o}{=} \PY{l+m+mi}{3}
        	\PY{k}{if} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{l+m+mi}{0}\PY{p}{:}
        		\PY{k}{return} \PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{math}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{p}{)}
        	\PY{k}{else}\PY{p}{:}
        		\PY{k}{return} \PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{math}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{p}{)}\PY{p}{)}
        
        \PY{k}{def} \PY{n+nf}{sigmoid4}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{p}{:}
        	\PY{n}{gamma} \PY{o}{*}\PY{o}{=} \PY{l+m+mi}{2}
        	\PY{k}{if} \PY{n}{gamma} \PY{o}{\PYZlt{}} \PY{l+m+mi}{0}\PY{p}{:}
        		\PY{k}{return} \PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{math}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{p}{)}
        	\PY{k}{else}\PY{p}{:}
        		\PY{k}{return} \PY{l+m+mi}{1}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{math}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{gamma}\PY{p}{)}\PY{p}{)}
        
        
        \PY{k}{def} \PY{n+nf}{Vfunction1}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{p}{:}
        	\PY{k}{return} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{tanh}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{p}{)}
        
        \PY{k}{def} \PY{n+nf}{Vfunction2}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{p}{:}
        	\PY{n}{val} \PY{o}{=} \PY{p}{(}\PY{n}{math}\PY{o}{.}\PY{n}{pi}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{p}{)}
        	\PY{n}{val} \PY{o}{/}\PY{o}{=} \PY{l+m+mi}{2}
        	\PY{n}{val} \PY{o}{*}\PY{o}{=} \PY{n}{gamma}
        	\PY{n}{val} \PY{o}{=} \PY{n}{math}\PY{o}{.}\PY{n}{erf}\PY{p}{(}\PY{n}{val}\PY{p}{)}
        	\PY{k}{return} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{val}\PY{p}{)}
        
        \PY{k}{def} \PY{n+nf}{Vfunction3}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{p}{:}
        	\PY{n}{val} \PY{o}{=} \PY{l+m+mi}{1} \PY{o}{+} \PY{n}{gamma}\PY{o}{*}\PY{n}{gamma}
        	\PY{n}{val} \PY{o}{=} \PY{n}{math}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{val}\PY{p}{)}
        	\PY{n}{val} \PY{o}{=} \PY{n}{gamma}\PY{o}{/}\PY{n}{val}
        	\PY{k}{return} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{val}\PY{p}{)}
        
        \PY{k}{def} \PY{n+nf}{Vfunction4}\PY{p}{(}\PY{n}{gamma}\PY{p}{)}\PY{p}{:}
        	\PY{n}{val}\PY{o}{=}\PY{p}{(}\PY{n}{math}\PY{o}{.}\PY{n}{pi}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{*}\PY{n}{gamma}
        	\PY{n}{val}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arctan}\PY{p}{(}\PY{n}{val}\PY{p}{)}
        	\PY{n}{val}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{/}\PY{n}{math}\PY{o}{.}\PY{n}{pi}\PY{p}{)}\PY{o}{*}\PY{n}{val}
        	\PY{k}{return} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{val}\PY{p}{)}
        
        
        \PY{k}{def} \PY{n+nf}{fitness}\PY{p}{(}\PY{n}{position}\PY{p}{)}\PY{p}{:}
        	\PY{n}{cols}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{flatnonzero}\PY{p}{(}\PY{n}{position}\PY{p}{)}
        	\PY{n}{val}\PY{o}{=}\PY{l+m+mi}{1}
        	\PY{k}{if} \PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{cols}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{:}
        		\PY{k}{return} \PY{n}{val}	
        	\PY{n}{clf} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
        	\PY{c+c1}{\PYZsh{}clf=KNeighborsClassifier(n\PYZus{}neighbors=5)}
        	\PY{c+c1}{\PYZsh{} clf=MLPClassifier( alpha=0.01, max\PYZus{}iter=1000) \PYZsh{}hidden\PYZus{}layer\PYZus{}sizes=(1000,500,100)}
        	\PY{c+c1}{\PYZsh{}cross=3}
        	\PY{c+c1}{\PYZsh{}test\PYZus{}size=(1/cross)}
        	\PY{c+c1}{\PYZsh{}X\PYZus{}train, X\PYZus{}test, y\PYZus{}train, y\PYZus{}test = train\PYZus{}test\PYZus{}split(trainX, trainy,  stratify=trainy,test\PYZus{}size=test\PYZus{}size)}
        	\PY{n}{train\PYZus{}data}\PY{o}{=}\PY{n}{trainX}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{cols}\PY{p}{]}
        	\PY{n}{test\PYZus{}data}\PY{o}{=}\PY{n}{testX}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{cols}\PY{p}{]}
        	\PY{n}{clf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}data}\PY{p}{,}\PY{n}{trainy}\PY{p}{)}
        	\PY{n}{val}\PY{o}{=}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{clf}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{test\PYZus{}data}\PY{p}{,}\PY{n}{testy}\PY{p}{)}
        
        	\PY{c+c1}{\PYZsh{}in case of multi objective  []}
        	\PY{n}{set\PYZus{}cnt}\PY{o}{=}\PY{n+nb}{sum}\PY{p}{(}\PY{n}{position}\PY{p}{)}
        	\PY{n}{set\PYZus{}cnt}\PY{o}{=}\PY{n}{set\PYZus{}cnt}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{position}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
        	\PY{n}{val}\PY{o}{=}\PY{n}{omega}\PY{o}{*}\PY{n}{val}\PY{o}{+}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{omega}\PY{p}{)}\PY{o}{*}\PY{n}{set\PYZus{}cnt}
        	\PY{k}{return} \PY{n}{val}
        
        \PY{k}{def} \PY{n+nf}{onecount}\PY{p}{(}\PY{n}{position}\PY{p}{)}\PY{p}{:}
        	\PY{n}{cnt}\PY{o}{=}\PY{l+m+mi}{0}
        	\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{position}\PY{p}{:}
        		\PY{k}{if} \PY{n}{i}\PY{o}{==}\PY{l+m+mf}{1.0}\PY{p}{:}
        			\PY{n}{cnt}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}
        	\PY{k}{return} \PY{n}{cnt}
        
        
        \PY{k}{def} \PY{n+nf}{allfit}\PY{p}{(}\PY{n}{population}\PY{p}{)}\PY{p}{:}
        	\PY{n}{x}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{population}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
        	\PY{n}{acc}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{x}\PY{p}{)}
        	\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{:}
        		\PY{n}{acc}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{n}{fitness}\PY{p}{(}\PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}     
        		\PY{c+c1}{\PYZsh{}print(acc[i])}
        	\PY{k}{return} \PY{n}{acc}
        
        \PY{k}{def} \PY{n+nf}{initialize}\PY{p}{(}\PY{n}{popSize}\PY{p}{,}\PY{n}{dim}\PY{p}{)}\PY{p}{:}
        	\PY{n}{population}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{popSize}\PY{p}{,}\PY{n}{dim}\PY{p}{)}\PY{p}{)}
        	\PY{n}{minn} \PY{o}{=} \PY{l+m+mi}{1}
        	\PY{n}{maxx} \PY{o}{=} \PY{n}{math}\PY{o}{.}\PY{n}{floor}\PY{p}{(}\PY{l+m+mf}{0.8}\PY{o}{*}\PY{n}{dim}\PY{p}{)}
        	\PY{k}{if} \PY{n}{maxx}\PY{o}{\PYZlt{}}\PY{n}{minn}\PY{p}{:}
        		\PY{n}{minn} \PY{o}{=} \PY{n}{maxx}
        
        	\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{popSize}\PY{p}{)}\PY{p}{:}
        		\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{n}{i}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{3} \PY{o}{+} \PY{l+m+mi}{10} \PY{o}{+} \PY{n}{time}\PY{o}{.}\PY{n}{time}\PY{p}{(}\PY{p}{)} \PY{p}{)} 
        		\PY{n}{no} \PY{o}{=} \PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{n}{minn}\PY{p}{,}\PY{n}{maxx}\PY{p}{)}
        		\PY{k}{if} \PY{n}{no} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        			\PY{n}{no} \PY{o}{=} \PY{l+m+mi}{1}
        		\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{n}{time}\PY{o}{.}\PY{n}{time}\PY{p}{(}\PY{p}{)}\PY{o}{+} \PY{l+m+mi}{100}\PY{p}{)}
        		\PY{n}{pos} \PY{o}{=} \PY{n}{random}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{dim}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{no}\PY{p}{)}
        		\PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n}{pos}\PY{p}{:}
        			\PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{1}
        
        		\PY{c+c1}{\PYZsh{} print(population[i])  }
        
        	\PY{k}{return} \PY{n}{population}
        
        \PY{k}{def} \PY{n+nf}{toBinary}\PY{p}{(}\PY{n}{population}\PY{p}{,}\PY{n}{popSize}\PY{p}{,}\PY{n}{dimension}\PY{p}{,}\PY{n}{oldPop}\PY{p}{)}\PY{p}{:}
        
        	\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{popSize}\PY{p}{)}\PY{p}{:}
        		\PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{dimension}\PY{p}{)}\PY{p}{:}
        			\PY{n}{temp} \PY{o}{=} \PY{n}{Vfunction3}\PY{p}{(}\PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{)}
        
        			\PY{c+c1}{\PYZsh{} if temp \PYZgt{} 0.5: \PYZsh{} sfunction}
        			\PY{c+c1}{\PYZsh{} 	population[i][j] = 1}
        			\PY{c+c1}{\PYZsh{} else:}
        			\PY{c+c1}{\PYZsh{} 	population[i][j] = 0}
        
        			\PY{k}{if} \PY{n}{temp} \PY{o}{\PYZgt{}} \PY{l+m+mf}{0.5}\PY{p}{:} \PY{c+c1}{\PYZsh{} vfunction}
        				\PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{oldPop}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{)}
        			\PY{k}{else}\PY{p}{:}
        				\PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{=} \PY{n}{oldPop}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{j}\PY{p}{]}
        	\PY{k}{return} \PY{n}{population}
        
        
        \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
        \PY{n}{omega} \PY{o}{=} \PY{l+m+mf}{0.9} \PY{c+c1}{\PYZsh{}weightage for no of features and accuracy}
        \PY{n}{popSize} \PY{o}{=} \PY{l+m+mi}{20}
        \PY{n}{max\PYZus{}iter} \PY{o}{=} \PY{l+m+mi}{10}
        \PY{n}{S} \PY{o}{=} \PY{l+m+mi}{2}
        
        
        \PY{c+c1}{\PYZsh{} df=pd.read\PYZus{}csv(sys.argv[1])}
        \PY{c+c1}{\PYZsh{} (a,b)=np.shape(df)}
        \PY{c+c1}{\PYZsh{} print(a,b)}
        \PY{c+c1}{\PYZsh{} data = df.values[:,0:b\PYZhy{}1]}
        \PY{c+c1}{\PYZsh{} label = df.values[:,b\PYZhy{}1]}
        \PY{c+c1}{\PYZsh{} dimension = np.shape(data)[1] \PYZsh{}particle dimension}
        
        
        \PY{n}{best\PYZus{}accuracy} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
        \PY{n}{best\PYZus{}no\PYZus{}features} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
        \PY{n}{average\PYZus{}accuracy} \PY{o}{=} \PY{l+m+mi}{0}
        \PY{n}{global\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
        \PY{n}{accuracy\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{n}{features\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        
        \PY{k}{for} \PY{n}{train\PYZus{}iteration} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1500}\PY{p}{)}\PY{p}{:}
        
        	\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        	\PY{c+c1}{\PYZsh{}I know I should not put not it here, but still ...}
        	\PY{n}{df}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C:/Users/IYI/Desktop/matlab\PYZus{}yedek/aaa\PYZus{}mineral/minerals/birlestirilmis\PYZus{}3000/FinalData\PYZus{}3000.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        	\PY{p}{(}\PY{n}{a}\PY{p}{,}\PY{n}{b}\PY{p}{)}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{df}\PY{p}{)}
        	\PY{c+c1}{\PYZsh{}print(a,b)}
        	\PY{n}{data} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{values}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{b}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        	\PY{n}{label} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{values}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{b}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        	\PY{n}{dimension} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{c+c1}{\PYZsh{}particle dimension}
        	\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        
        	\PY{n}{cross} \PY{o}{=} \PY{l+m+mi}{5}
        	\PY{n}{test\PYZus{}size} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{n}{cross}\PY{p}{)}
        	\PY{n}{trainX}\PY{p}{,} \PY{n}{testX}\PY{p}{,} \PY{n}{trainy}\PY{p}{,} \PY{n}{testy} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{label}\PY{p}{,}\PY{n}{stratify}\PY{o}{=}\PY{n}{label} \PY{p}{,}\PY{n}{test\PYZus{}size}\PY{o}{=}\PY{n}{test\PYZus{}size}\PY{p}{)}
        
        
        	\PY{n}{clf} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
        	\PY{c+c1}{\PYZsh{}clf=KNeighborsClassifier(n\PYZus{}neighbors=5)}
        	\PY{c+c1}{\PYZsh{} clf=MLPClassifier(alpha=0.001, max\PYZus{}iter=1000) \PYZsh{}hidden\PYZus{}layer\PYZus{}sizes=(1000,500,100)}
        	\PY{n}{clf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{trainX}\PY{p}{,}\PY{n}{trainy}\PY{p}{)}
        	\PY{n}{val}\PY{o}{=}\PY{n}{clf}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{testX}\PY{p}{,}\PY{n}{testy}\PY{p}{)}
        	\PY{n}{whole\PYZus{}accuracy} \PY{o}{=} \PY{n}{val}
        	\PY{c+c1}{\PYZsh{}print(\PYZdq{}Total Acc: \PYZdq{},val)}
        
        	\PY{c+c1}{\PYZsh{} for population\PYZus{}iteration in range(2):}
        	\PY{n}{global\PYZus{}count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
        	\PY{c+c1}{\PYZsh{}print(\PYZsq{}global: \PYZsq{},global\PYZus{}count)}
        
        	\PY{n}{x\PYZus{}axis} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        	\PY{n}{y\PYZus{}axis} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        
        	\PY{n}{population} \PY{o}{=} \PY{n}{initialize}\PY{p}{(}\PY{n}{popSize}\PY{p}{,}\PY{n}{dimension}\PY{p}{)}
        	\PY{c+c1}{\PYZsh{} print(population)}
        
        	\PY{n}{start\PYZus{}time} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{now}\PY{p}{(}\PY{p}{)}
        	\PY{n}{fitList} \PY{o}{=} \PY{n}{allfit}\PY{p}{(}\PY{n}{population}\PY{p}{)}
        	\PY{n}{bestInx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argmin}\PY{p}{(}\PY{n}{fitList}\PY{p}{)}
        	\PY{n}{fitBest} \PY{o}{=} \PY{n+nb}{min}\PY{p}{(}\PY{n}{fitList}\PY{p}{)}
        	\PY{n}{Mbest} \PY{o}{=} \PY{n}{population}\PY{p}{[}\PY{n}{bestInx}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
        	\PY{k}{for} \PY{n}{currIter} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{max\PYZus{}iter}\PY{p}{)}\PY{p}{:}
        
        		\PY{n}{popnew} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{popSize}\PY{p}{,}\PY{n}{dimension}\PY{p}{)}\PY{p}{)}
        		\PY{n}{x\PYZus{}axis}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{currIter}\PY{p}{)}
        		\PY{n}{y\PYZus{}axis}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{min}\PY{p}{(}\PY{n}{fitList}\PY{p}{)}\PY{p}{)}
        		\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{popSize}\PY{p}{)}\PY{p}{:}
        			\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{n}{time}\PY{o}{.}\PY{n}{time}\PY{p}{(}\PY{p}{)} \PY{o}{+} \PY{l+m+mf}{10.01}\PY{p}{)}
        			\PY{n}{randNo} \PY{o}{=} \PY{n}{random}\PY{o}{.}\PY{n}{random}\PY{p}{(}\PY{p}{)}
        			\PY{k}{if} \PY{n}{randNo}\PY{o}{\PYZlt{}}\PY{l+m+mf}{0.5} \PY{p}{:}
        				\PY{c+c1}{\PYZsh{}chain foraging}
        				\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{n}{time}\PY{o}{.}\PY{n}{time}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        				\PY{n}{r} \PY{o}{=} \PY{n}{random}\PY{o}{.}\PY{n}{random}\PY{p}{(}\PY{p}{)}
        				\PY{n}{alpha} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{r}\PY{o}{*}\PY{p}{(}\PY{n+nb}{abs}\PY{p}{(}\PY{n}{math}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{r}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mf}{0.5}\PY{p}{)}
        				\PY{k}{if} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
        					\PY{n}{popnew}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{n}{r} \PY{o}{*} \PY{p}{(}\PY{n}{Mbest} \PY{o}{\PYZhy{}} \PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{n}{alpha}\PY{o}{*}\PY{p}{(}\PY{n}{Mbest} \PY{o}{\PYZhy{}} \PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
        				\PY{k}{else}\PY{p}{:}
        					\PY{n}{popnew}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{n}{r} \PY{o}{*} \PY{p}{(}\PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{n}{alpha}\PY{o}{*}\PY{p}{(}\PY{n}{Mbest} \PY{o}{\PYZhy{}} \PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
        			\PY{k}{else}\PY{p}{:}
        				\PY{c+c1}{\PYZsh{}cyclone foraging}
        				\PY{n}{cutOff} \PY{o}{=} \PY{n}{random}\PY{o}{.}\PY{n}{random}\PY{p}{(}\PY{p}{)}
        				\PY{n}{r} \PY{o}{=} \PY{n}{random}\PY{o}{.}\PY{n}{random}\PY{p}{(}\PY{p}{)}
        				\PY{n}{r1} \PY{o}{=} \PY{n}{random}\PY{o}{.}\PY{n}{random}\PY{p}{(}\PY{p}{)}
        				\PY{n}{beta} \PY{o}{=} \PY{l+m+mi}{2} \PY{o}{*} \PY{n}{math}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{n}{r1} \PY{o}{*} \PY{p}{(}\PY{n}{max\PYZus{}iter} \PY{o}{\PYZhy{}} \PY{n}{currIter} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{/} \PY{n}{max\PYZus{}iter}\PY{p}{)} \PY{o}{*} \PY{n}{math}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{l+m+mi}{2} \PY{o}{*} \PY{n}{math}\PY{o}{.}\PY{n}{pi} \PY{o}{*} \PY{n}{r1}\PY{p}{)}
        				\PY{k}{if} \PY{n}{currIter}\PY{o}{/}\PY{n}{max\PYZus{}iter} \PY{o}{\PYZlt{}} \PY{n}{cutOff}\PY{p}{:}
        					\PY{c+c1}{\PYZsh{} exploration}
        					\PY{n}{Mrand} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{population}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        					\PY{n}{no} \PY{o}{=} \PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n+nb}{max}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{l+m+mf}{0.1}\PY{o}{*}\PY{n}{dimension}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
        					\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{n}{time}\PY{o}{.}\PY{n}{time}\PY{p}{(}\PY{p}{)}\PY{o}{+} \PY{l+m+mi}{100}\PY{p}{)}
        					\PY{n}{pos} \PY{o}{=} \PY{n}{random}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{dimension}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{no}\PY{p}{)}
        					\PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n}{pos}\PY{p}{:}
        						\PY{n}{Mrand}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{1}
        
        					\PY{k}{if} \PY{n}{i}\PY{o}{==}\PY{l+m+mi}{1} \PY{p}{:}
        						\PY{n}{popnew}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{Mrand} \PY{o}{+} \PY{n}{r} \PY{o}{*} \PY{p}{(}\PY{n}{Mrand} \PY{o}{\PYZhy{}} \PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{n}{beta} \PY{o}{*} \PY{p}{(}\PY{n}{Mrand} \PY{o}{\PYZhy{}} \PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
        					\PY{k}{else}\PY{p}{:}
        						\PY{n}{popnew}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{Mrand} \PY{o}{+} \PY{n}{r} \PY{o}{*} \PY{p}{(}\PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{n}{beta} \PY{o}{*} \PY{p}{(}\PY{n}{Mrand} \PY{o}{\PYZhy{}} \PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
        				\PY{k}{else}\PY{p}{:}
        					\PY{c+c1}{\PYZsh{} exploitation}
        					\PY{k}{if} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
        						\PY{n}{popnew}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{Mbest} \PY{o}{+} \PY{n}{r} \PY{o}{*} \PY{p}{(}\PY{n}{Mbest} \PY{o}{\PYZhy{}} \PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{n}{beta} \PY{o}{*} \PY{p}{(}\PY{n}{Mbest} \PY{o}{\PYZhy{}} \PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
        					\PY{k}{else}\PY{p}{:}
        						\PY{n}{popnew}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{Mbest} \PY{o}{+} \PY{n}{r} \PY{o}{*} \PY{p}{(}\PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{n}{beta} \PY{o}{*} \PY{p}{(}\PY{n}{Mbest} \PY{o}{\PYZhy{}} \PY{n}{population}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
        
        		\PY{c+c1}{\PYZsh{} print(popnew)}
        
        		\PY{n}{popnew} \PY{o}{=} \PY{n}{toBinary}\PY{p}{(}\PY{n}{popnew}\PY{p}{,}\PY{n}{popSize}\PY{p}{,}\PY{n}{dimension}\PY{p}{,}\PY{n}{population}\PY{p}{)}
        		\PY{n}{popnewTemp} \PY{o}{=} \PY{n}{popnew}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
        		\PY{c+c1}{\PYZsh{}compute fitness for each individual}
        		\PY{n}{fitList} \PY{o}{=} \PY{n}{allfit}\PY{p}{(}\PY{n}{popnew}\PY{p}{)}
        		\PY{k}{if} \PY{n+nb}{min}\PY{p}{(}\PY{n}{fitList}\PY{p}{)}\PY{o}{\PYZlt{}}\PY{n}{fitBest} \PY{p}{:}
        			\PY{n}{bestInx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argmin}\PY{p}{(}\PY{n}{fitList}\PY{p}{)}
        			\PY{n}{fitBest} \PY{o}{=} \PY{n+nb}{min}\PY{p}{(}\PY{n}{fitList}\PY{p}{)}
        			\PY{n}{Mbest} \PY{o}{=} \PY{n}{popnew}\PY{p}{[}\PY{n}{bestInx}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
        		\PY{c+c1}{\PYZsh{} print(fitList,fitBest)}
        
        		\PY{c+c1}{\PYZsh{}somersault foraging}
        		\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{popSize}\PY{p}{)}\PY{p}{:}
        			\PY{n}{r2} \PY{o}{=} \PY{n}{random}\PY{o}{.}\PY{n}{random}\PY{p}{(}\PY{p}{)}
        			\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{n}{time}\PY{o}{.}\PY{n}{time}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        			\PY{n}{r3} \PY{o}{=} \PY{n}{random}\PY{o}{.}\PY{n}{random}\PY{p}{(}\PY{p}{)}
        			\PY{n}{popnew}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{popnew}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{n}{S} \PY{o}{*} \PY{p}{(}\PY{n}{r2}\PY{o}{*}\PY{n}{Mbest} \PY{o}{\PYZhy{}} \PY{n}{r3}\PY{o}{*}\PY{n}{popnew}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
        
        		\PY{n}{popnew} \PY{o}{=} \PY{n}{toBinary}\PY{p}{(}\PY{n}{popnew}\PY{p}{,}\PY{n}{popSize}\PY{p}{,}\PY{n}{dimension}\PY{p}{,}\PY{n}{popnewTemp}\PY{p}{)}
        		\PY{c+c1}{\PYZsh{}compute fitness for each individual}
        		\PY{n}{fitList} \PY{o}{=} \PY{n}{allfit}\PY{p}{(}\PY{n}{popnew}\PY{p}{)}
        		\PY{k}{if} \PY{n+nb}{min}\PY{p}{(}\PY{n}{fitList}\PY{p}{)}\PY{o}{\PYZlt{}}\PY{n}{fitBest} \PY{p}{:}
        			\PY{n}{bestInx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argmin}\PY{p}{(}\PY{n}{fitList}\PY{p}{)}
        			\PY{n}{fitBest} \PY{o}{=} \PY{n+nb}{min}\PY{p}{(}\PY{n}{fitList}\PY{p}{)}
        			\PY{n}{Mbest} \PY{o}{=} \PY{n}{popnew}\PY{p}{[}\PY{n}{bestInx}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
        		\PY{c+c1}{\PYZsh{} print(fitList,fitBest)}
        
        		\PY{n}{population} \PY{o}{=} \PY{n}{popnew}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
        
        
        	\PY{n}{time\PYZus{}required} \PY{o}{=} \PY{n}{datetime}\PY{o}{.}\PY{n}{now}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{start\PYZus{}time}
        
        	\PY{c+c1}{\PYZsh{} pyplot.plot(x\PYZus{}axis,y\PYZus{}axis)}
        	\PY{c+c1}{\PYZsh{} pyplot.xlim(0,max\PYZus{}iter)}
        	\PY{c+c1}{\PYZsh{} pyplot.ylim(max(0,min(y\PYZus{}axis)\PYZhy{}0.1),min(max(y\PYZus{}axis)+0.1,1))}
        	\PY{c+c1}{\PYZsh{} pyplot.show()}
        
        
        	\PY{n}{output} \PY{o}{=} \PY{n}{Mbest}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
        	\PY{c+c1}{\PYZsh{}print(output)}
        
        	\PY{c+c1}{\PYZsh{}test accuracy}
        	\PY{n}{cols}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{flatnonzero}\PY{p}{(}\PY{n}{output}\PY{p}{)}
        	\PY{c+c1}{\PYZsh{}print(cols)}
        	\PY{n}{X\PYZus{}test}\PY{o}{=}\PY{n}{testX}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{cols}\PY{p}{]}
        	\PY{n}{X\PYZus{}train}\PY{o}{=}\PY{n}{trainX}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{cols}\PY{p}{]}
        	\PY{c+c1}{\PYZsh{}print(np.shape(feature))}
        
        	\PY{n}{clf} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
        	\PY{c+c1}{\PYZsh{}clf=KNeighborsClassifier(n\PYZus{}neighbors=5)}
        	\PY{c+c1}{\PYZsh{}clf=MLPClassifier( alpha=0.001, max\PYZus{}iter=2000) \PYZsh{}hidden\PYZus{}layer\PYZus{}sizes=(1000,500,100 ),}
        	\PY{n}{clf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{trainy}\PY{p}{)}
        	\PY{n}{val}\PY{o}{=}\PY{n}{clf}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{testy} \PY{p}{)}
        	
        
        	\PY{n}{accuracy\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{val}\PY{p}{)}
        	\PY{n}{features\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{onecount}\PY{p}{(}\PY{n}{output}\PY{p}{)}\PY{p}{)}
        	\PY{k}{if} \PY{p}{(} \PY{n}{val} \PY{o}{==} \PY{n}{best\PYZus{}accuracy} \PY{p}{)} \PY{o+ow}{and} \PY{p}{(} \PY{n}{onecount}\PY{p}{(}\PY{n}{output}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{n}{best\PYZus{}no\PYZus{}features} \PY{p}{)}\PY{p}{:}
        		\PY{n}{best\PYZus{}accuracy} \PY{o}{=} \PY{n}{val}
        		\PY{n}{best\PYZus{}no\PYZus{}features} \PY{o}{=} \PY{n}{onecount}\PY{p}{(} \PY{n}{output} \PY{p}{)}
        		\PY{n}{best\PYZus{}time\PYZus{}req} \PY{o}{=} \PY{n}{time\PYZus{}required}
        		\PY{n}{best\PYZus{}whole\PYZus{}accuracy} \PY{o}{=} \PY{n}{whole\PYZus{}accuracy}
        		\PY{c+c1}{\PYZsh{}print(onecount(output))}
        	\PY{k}{if} \PY{n}{val} \PY{o}{\PYZgt{}} \PY{n}{best\PYZus{}accuracy} \PY{p}{:}
        		\PY{n}{best\PYZus{}accuracy} \PY{o}{=} \PY{n}{val}
        		\PY{n}{best\PYZus{}no\PYZus{}features} \PY{o}{=} \PY{n}{onecount}\PY{p}{(} \PY{n}{output} \PY{p}{)}
        		\PY{n}{best\PYZus{}time\PYZus{}req} \PY{o}{=} \PY{n}{time\PYZus{}required}
        		\PY{n}{best\PYZus{}whole\PYZus{}accuracy} \PY{o}{=} \PY{n}{whole\PYZus{}accuracy}
        		\PY{c+c1}{\PYZsh{}print(onecount(output))}
        	\PY{n+nb}{print}\PY{p}{(}\PY{n}{onecount}\PY{p}{(}\PY{n}{output}\PY{p}{)}\PY{p}{)}
        
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{best\PYZus{}no\PYZus{}features}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} print(\PYZsq{}avg: \PYZsq{},average\PYZus{}accuracy/10)}
        
        
        \PY{c+c1}{\PYZsh{} accuracy\PYZus{}list = np.array(accuracy\PYZus{}list)}
        \PY{c+c1}{\PYZsh{} accuracy\PYZus{}list.sort()}
        \PY{c+c1}{\PYZsh{} accuracy\PYZus{}list = accuracy\PYZus{}list[\PYZhy{}4:]}
        \PY{c+c1}{\PYZsh{} average = np.mean(accuracy\PYZus{}list)}
        \PY{c+c1}{\PYZsh{} stddev = np.std(accuracy\PYZus{}list)}
        
        \PY{c+c1}{\PYZsh{} accuracy\PYZus{}list = list(accuracy\PYZus{}list)}
        \PY{c+c1}{\PYZsh{} avgFea = 0}
        \PY{c+c1}{\PYZsh{} for i in accuracy\PYZus{}list:}
        \PY{c+c1}{\PYZsh{} 	inx = accuracy\PYZus{}list.index(i)}
        \PY{c+c1}{\PYZsh{} 	avgFea += features\PYZus{}list[inx]}
        \PY{c+c1}{\PYZsh{} avgFea /= 4}
        
        \PY{n}{temp}\PY{o}{=}\PY{n}{sys}\PY{o}{.}\PY{n}{argv}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C:/Users/IYI/Desktop/matlab\PYZus{}yedek/aaa\PYZus{}mineral/minerals/birlestirilmis\PYZus{}3000/FinalData\PYZus{}3001.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f}\PY{p}{:}
        	\PY{n+nb}{print}\PY{p}{(}\PY{n}{temp}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{l+m+mi}{100}\PY{o}{*}\PY{n}{best\PYZus{}whole\PYZus{}accuracy}\PY{p}{)} \PY{p}{,}
        		\PY{n}{np}\PY{o}{.}\PY{n}{shape}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{l+m+mi}{100}\PY{o}{*}\PY{n}{best\PYZus{}accuracy}\PY{p}{)}\PY{p}{,}\PY{n}{best\PYZus{}no\PYZus{}features}\PY{p}{,}\PY{n}{file}\PY{o}{=}\PY{n}{f}\PY{p}{)} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
639
254
160
675
983
1581
173
674
1922
2599
563
1846
835
892
437
964
633
864
535
1389
447
561
1093
1974
468
692
788
225
1295
855
321
795
753
1210
140
417
508
344
737
793
873
238
271
1865
396
1139
886
528
1117
849
521
382
233
1064
449
896
531
1013
1879
402
1265
111
591
336
872
216
1304
2367
709
1954
752
1086
234
314
2217
1150
1027
389
1784
258
843
465
641
776
1105
1416
390
776
1360
1600
209
1125
1270
391
977
769
1525
857
447
440
154
2000
1672
359
1069
855
2146
1154
529
920
483
353
366
1723
1926
1265
1806
701
1958
777
923
850
1241
429
1185
1900
195
450
1528
235
962
778
820
173
2052
373
830
471
891
2365
375
741
697
595
840
355
1604
562
439
866
1141
642
1118
851
1069
1750
984
491
1805
666
729
803
552
1154
852
740
710
626
910
1585
1488
976
303
471
367
1080
1008
868
422
584
799
548
918
2067
1422
909
1049
1260
368
1518
289
361
180
1144
537
1598
189
1603
1478
1120
820
412
1073
591
957
891
671
1633
1533
532
682
1518
645
1080
1266
990
1104
1194
946
1325
528
1397
880
434
172
1003
932
315
910
445
903
756
757
865
762
430
98
1110
240
747
138
406
576
988
658
165
731
731
289
153
1973
349
1068
580
2006
939
1112
724
1652
382
489
1004
817
1390
1208
677
750
496
1026
227
2055
939
1904
1517
296
383
1402
243
798
604
453
980
458
1597
983
170
952
619
941
1043
771
2414
191
942
1480
851
1189
997
1332
1175
399
745
1049
183
1421
424
1437
419
1444
150
580
1062
687
1071
298
292
452
1542
1069
1952
1536
1481
399
2232
1485
614
898
985
188
256
727
382
1211
902
529
305
1271
575
954
1173
650
286
398
1318
850
952
514
385
640
683
867
966
888
678
466
1628
1482
1062
346
456
739
669
689
799
982
969
762
1520
1021
105
1015
608
788
306
343
1513
691
821
932
1501
787
213
539
227
234
1545
685
288
61
313
1913
796
683
1439
893
1491
1569
648
290
664
896
499
1523
602
833
1771
1687
348
487
782
822
486
392
963
1182
876
723
563
352
351
473
1620
642
206
312
875
336
349
1154
811
1305
410
1446
1418
228
173
1362
782
2048
399
1768
516
598
1204
1500
2027
1244
769
484
1266
866
676
145
1110
231
458
394
1754
426
390
1515
737
541
1151
721
922
747
980
755
921
537
1562
486
430
395
1517
2021
1415
319
399
1975
521
1432
1589
1154
698
1063
1909
863
224
574
1388
643
1975
839
1096
1442
1218
481
489
1128
812
116
522
1342
894
679
1370
286
982
1761
1663
1463
1352
2175
697
590
398
344
312
1020
384
1570
535
553
672
1018
710
392
1575
2028
1388
981
612
818
1169
932
300
853
271
416
1201
807
1074
1081
377
396
689
468
1702
140
1154
785
936
787
499
1366
948
1132
733
1205
1830
470
645
1370
659
514
652
578
1025
673
1555
79
790
155
633
1306
254
1657
1261
151
1033
1079
688
862
1853
623
654
227
668
440
567
1012
1604
1366
1255
1326
759
1421
496
1452
261
800
1174
1228
2393
440
525
263
475
777
738
386
552
1293
601
1309
549
1381
890
729
245
588
1719
605
390
1052
889
399
1405
150
1018
1184
548
942
1620
182
1113
1309
1793
233
277
801
1588
1508
755
464
410
1412
454
836
930
694
192
175
1146
630
1492
797
598
182
604
2013
510
770
296
492
1710
908
1200
1044
700
1008
2236
256
1031
1161
887
1362
528
373
324
621
699
1992
237
588
1870
1386
1182
1026
1242
393
1312
645
526
301
1559
761
590
441
462
1395
1435
774
229
133
1845
924
855
1690
1370
1328
1268
416
371
1332
556
776
649
427
509
1410
158
703
886
603
768
280
1349
303
1288
749
2070
1291
1863
630
479
984
1873
1060
1189
834
693
325
1188
419
1043
725
908
1297
235
1121
585
1301
349
938
1259
587
671
607
2043
1593
399
108
390
1050
631
154
888
992
1079
459
1798
643
467
1365
249
268
1724
166
531
159
871
674
1072
1008
1000
1425
293
1121
820
157
256
740
1110
1165
177
651
1661
1047
696
1214
1466
2182
704
1052
407
1397
686
623
361
165
523
263
1098
344
725
273
281
201
539
242
518
472
1065
1451
1493
1528
1202
863
407
321
240
687
723
507
1052
1346
584
1104
743
1589
236
751
380
1016
1251
792
229
1354
469
1582
786
1449
321
1294
1716
1761
742
672
1126
407
746
535
1556
835
1736
803
2173
2302
667
432
680
515
1388
546
1288
183
1561
497
1681
760
1062
418
1456
255
621
1815
1570
671
1153
633
1318
253
362
750
61
1207
1066
1097
1451
581
1445
505
437
427
1009
1124
695
805
649
670
1909
759
1084
1173
1400
897
509
1062
1536
933
2144
747
820
965
1032
210
413
248
1489
878
1381
1009
538
317
1089
1149
1398
1010
676
691
2135
1636
1103
1988
642
762
1134
1499
639
858
876
541
1411
1442
929
356
554
1774
375
476
149
1540
1925
574
755
540
865
1387
121
656
426
1730
445
1171
566
1112
1146
1586
1014
667
117
296
407
921
843
228
1332
847
2218
411
422
328
300
1192
1035
1913
2347
636
497
177
806
1260
183
336
380
671
982
1701
587
566
1249
425
442
384
750
1262
1872
454
324
1132
138
1129
1175
391
844
290
1427
665
964
1206
885
725
180
1015
671
819
536
930
541
783
955
982
1262
1061
1540
445
609
639
485
1101
1149
432
2331
650
1461
1404
1226
1318
159
302
377
927
1143
664
346
1289
2208
1121
388
664
1586
1118
1012
408
337
1477
529
1457
323
284
104
628
482
920
1799
1159
2175
461
504
207
578
456
581
849
1468
906
1245
1346
1211
377
1990
709
383
196
1070
468
303
195
2320
913
617
1148
171
1293
388
1018
264
1258
460
477
1030
885
1388
685
646
1040
584
635
1297
323
1176
759
555
1188
1020
212
1354
360
502
1049
585
840
735
399
1277
623
712
1948
886
435
941
1112
1264
1194
242
1628
1162
744
1125
1264
706
1607
181
103
880
1378
1121
624
639
864
891
1732
996
646
1349
799
1821
855
559
1512
1389
887
442
1115
456
1941
407
986
1227
599
1443
1418
765
690
354
548
827
534
526
484
528
425
531
310
340
187
433
292
885
826
801
1308
996
1308
968
852
150
201
760
212
1519
1003
477
397
752
1436
1176
1340
979
481
1278
2163
232
1080
239
323
530
605
1427
1371
1429
754
1228
732
1020
1123
1080
75
577
262
247
486
700
432
1336
557
175
423
338
791
654
1522
344
384
835
548
331
381
764
646
777
560
1237
355
673
687
327
421
372
938
1365
898
420
755
449
1384
740
344
245
840
1556
1505
115
617
604
960
1564
1566
734
327
281
1261
154
645
690
450
845
174
1317
558
1395
1167
791
807
208
1267
435
1248
441
460
529
1774
470
801
213
431
653
136
701
1360
1336
1442
225
894
805
1512
975
429
1409
213
1497
522
531
553
1248
197
1249
743
887
364
542
825
1084
1028
387
292
858
1215
448
1169
565
969
878
1164
156
282
331
1676
860
505
1421
1209
342
817
1090
565
1175
1274
1213
1270
699
839
1367
2257
269
860
1385
666
899
733
646
640
2089
648
1178
663
519
134
509
1144
157
230
1114
553
783
1592
1211
1301
103
439
1167
1212
613
2302
258
1972
883
944
391
588
211
300
2047
1203
2212
822
667
714
1189
942
471
516
940
1129
1516
859
169
519
989
1291
925
87
614
306
791
942
835
1827
158
1037
921
1026
1080
1363
709
831
755
1269
262
213
1388
772
495
138
1285
1770
453
1363
381
231
1276
866
810
1393
287
927
379
1210
1067
398
643
1663
716
1680
1380
686
1363
504
622
811
771
1028
2378
158
939
371
1993
 1202

    \end{Verbatim}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
